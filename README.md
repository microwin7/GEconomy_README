<p align="center">
  <img src="https://user-images.githubusercontent.com/37264286/222985646-4be8b2e8-57ec-45cf-8295-0d1ed8522971.png" alt="GEconomy Image" width="500">
</p>

> Данный плагин разрабатывался для того, чтобы уйти от всему нами любимого **iConomy**.
> С данным плагином я был знаком с 2016 года и на тот момент он считался чем-то
> неотъемлемым и незаменимым для создания своего проекта в майнкрафте. Но время
> идёт и на смену проверенному временем плагину должен приходить другой. По моему
> сугубо личному мнению, каждый проект уже давно должен отказаться от него, поскольку
> в нём очень много недочётов в плане производительности. Поработав довольно продолжительное
> время с этим плагином, я и мой колега решили, что пора что-то менять. Скажу честно,
> мы не долго искали в интернете замену, с первых минут нам стало ясно, что эту проблему
> нам придётся решать своими руками. Собрались одним вечером и написали данный плагин,
> взяв от iConomy всё самое хорошее и оставив позади плохое. Представляю вашему вниманию, **GEconomy**

### Преимущества плагина
✔ Данный плагин работает асинхронно с базой данных, на борту <a href="https://github.com/brettwooldridge/HikariCP">HikariCP </a><br />
✔ У всех серверов общая таблица, что позволяет вам легко выводить информацию о вашем балансе на сайте<br />
✔ Существует вторая таблица для перевода реальной валюты в игровую, зачисление в самой игре происходит через 5 секунд<br />
✔ Всю информацию о балансе игрока он хранит в кеше<br />
✔ Возможность перенести базу данных с таблицы iConomy<br />
✔ Присутствует API для взаимодействия с плагином<br />
✔ Есть возможность вывести для мода информацию о балансе игрока, пример будет описан ниже <br />

### Команды
| Написание команды                                    | Права на команду       | Описание команды                                   |
| ---------------------------------------------------- | :--------------------: | -------------------------------------------------- |
| `/money`                                             |           -            | Получить свой баланс                               |
| `/money <Имя_Игрока>`                                | geconomy.player.info   | Получить баланс игрока                             |
| `/money pay <Имя_Игрока> <Количество>`               |           -            | Перевести игроку n-ое количество со свой средств   |
| `/pay <Имя_Игрока> <Количество>`                     |           -            | Перевести игроку n-ое количество со свой средств   |
| `/eco give <Имя_Игрока> <Количество>`                | geconomy.admin         | Выдать n-ое количество денег на счёт игрока        |
| `/eco take <Имя_Игрока> <Количество>`                | geconomy.admin         | Забрать n-ое количество денег на счёт игрока       |
| `/eco set <Имя_Игрока> <Количество>`                 | geconomy.admin         | Установить n-ое количество денег на счёт игрока    |
| `/eco migrate <table> <name_column>` `<value_column` | geconomy.admin.migrate | Миграция с **iConomy**                             |
| `/eco reload`                                        | geconomy.admin         | Перезагрузить конфиг                               |


### Перейдем же к настройке плагина
>__Warning__ После подгрузки плагина появится ошибка в консоли.
>
>Она будет вам говорит о том, что вам нужно заполнить данные в конфиге
```yaml
database:
  server:     # Укажите псевдоним для вашего сервера, по нему и будет считывать информация с базы данных
  host:       # Ip-адрес вашей базы данных (default: 127:0.0.1)
  port:       # Порт вашей базы данных (default: 3306)
  database:   # Название вашей базы данных
  username:   # Имя вашей учетной записи
  password:   # Пароль от вашей учетной записи
```

# API (Для разработчиков)

**Нам необходимо в первую очередь получить PlayerData нашего игрока**
```java
 /*
  * @param uuid - уникальный идентификатор игрока
  */
  PlayerData playerData = GEconomy.getBank().get(UUID uuid)
````
**Основные методы API, которыми вы будете оперировать**

```java
 /*
  * Получить баланс игрока
  */
  playerData.getMoney();
```
```java
 /*
  * Установить баланс игроку
  * @param value - переменная типа double
  */
  playerData.set(value);
```
```java
 /*
  * Начислить на баланс игрока
  * @param value - переменная типа double
  */
  playerData.deposit(value);
```
```java
 /*
  * Снять с баланса игрока
  * @param value - переменная типа double
  */
  playerData.withdraw(value);
```
**Вы также можете прослушивать плагин с помощью специального ивента `EconomyChangeEvent.java`**

```java
    @EventHandler
    public void onEconomyChangeEvent(vladimir.vsauko.utils.EconomyChangeEvent event) {
        getLogger().info("EconomyChangeEvent");
        getLogger().info("UUID: " + event.getUuid().toString());
        getLogger().info("prev: " + event.getPrev());
        getLogger().info("current: " + event.getCurrent());
        getLogger().info("type: " + event.getType());
        
    }
```

> `getUuid()` - Получить уникальный идентификатор пользователя
> 
> `getPrev()` - Получить баланс до изменения
> 
> `getCurrent()` - Получить баланс после изменения
> 
> `getType()` - Получить причину изменения баланса у игрока 
>
>   TYPE: `DEPOSIT, SET, WITHDRAW, OUTSIDE, CREATE_PLAYER`


**Если вы хотите вывести информацию о балансе игрока в моде, то этот код для вас**
```java
 @SubscribeEvent
    public void onClientPacket(FMLNetworkEvent.ClientCustomPacketEvent event) {
        if(event.packet.channel().equals("GEconomy:balanceInfo")) {
            ByteBuf buf = event.packet.payload();
            ByteBufUtils.readUTF8String(buf); // Здесь вы получите баланс игрока
            ByteBufUtils.readUTF8String(buf); // Здесь вы получите символ валюты
        }
    }
```
